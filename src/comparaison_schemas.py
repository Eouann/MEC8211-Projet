"""
Fichier de comparaison des différentes schémas de différence finie codés
"""


#Importation de bibliothèques
import matplotlib.pyplot as plt
import numpy as np

A = np.array([ 1873., 1845.35857515, 1817.7305285, 1790.12921852, 1762.56796423,
    1735.06002562, 1707.61858416, 1680.25672359, 1652.98741084, 1625.82347731,
    1598.77760045, 1571.86228571, 1545.08984892, 1518.47239907, 1492.02182169,
    1465.74976262, 1439.66761247, 1413.78649161, 1388.11723582, 1362.67038257,
    1337.45615802, 1312.48446473, 1287.76487005, 1263.30659537, 1239.11850602,
    1215.20910206, 1191.58650978, 1168.25847411, 1145.23235172, 1122.51510508,
    1100.1132972, 1078.03308733, 1056.28022733, 1034.86005903, 1013.7775122,
    993.03710349, 972.64293603, 952.59869985, 932.90767304, 913.57272365,
    894.5963123, 875.98049542, 857.72692926, 839.83687448, 822.31120129,
    805.15039528, 788.35456376, 771.92344255, 755.8564034, 740.1524617,
    724.81028476, 709.82820039, 695.20420584, 680.93597707, 667.02087835,
    653.45597199, 640.23802843, 627.36353637, 614.82871314, 602.62951513,
    590.76164834, 579.22057891, 568.00154372, 557.09956094, 546.50944053,
    536.22579471, 526.24304823, 516.55544857, 507.15707603, 498.04185351,
    489.20355616, 480.63582086, 472.33215531, 464.28594698, 456.49047175,
    448.93890219, 441.6243156, 434.53970173, 427.6779701, 421.03195706,
    414.59443244, 408.35810588, 402.31563281, 396.45962004, 390.78263101,
    385.27719066, 379.93579001, 374.75089029, 369.71492679, 364.82031238,
    360.05944063, 355.42468865, 350.90841967, 346.50298521, 342.20072705,
    337.99397889, 333.87506776, 329.83631521, 325.87003823, 321.96855001])


B = np.array([
    1873., 1845.46635288, 1817.9385481, 1790.44847991, 1762.98619803,
    1735.58474339, 1708.24382394, 1680.98287365, 1653.81233375, 1626.74521443,
    1599.7940372, 1572.97103873, 1546.2883334, 1519.75783936, 1493.39125373,
    1467.20004441, 1441.19543551, 1415.38839191, 1389.7896053, 1364.409481,
    1339.25812538, 1314.34533381, 1289.68057935, 1265.27300219, 1241.13139969,
    1217.2642173, 1193.67954012, 1170.38508524, 1147.38819487, 1124.69583022,
    1102.31456614, 1080.25058656, 1058.50968068, 1037.09723996, 1016.01825578,
    995.27731799, 974.87861409, 954.82592919, 935.12264669, 915.77174962,
    896.7758227, 878.13705503, 859.85724349, 841.93779663, 824.37973926,
    807.18371759, 790.35000486, 773.87850752, 757.76877189, 742.01999126,
    726.6310134, 711.60034852, 696.92617748, 682.60636045, 668.63844578,
    655.01967912, 641.74701285, 628.81711565, 616.22638219, 603.97094306,
    592.04667471, 580.44920947, 569.17394567, 558.21605768, 547.57050598,
    537.2320472, 527.195244, 517.45447495, 508.00394423, 498.83769113,
    489.94959952, 481.33340695, 472.98271366, 464.89099131, 457.0515915,
    449.45775392, 442.10261434, 434.97921228, 428.08049831, 421.3993411,
    414.92853417, 408.66080224, 402.58880729, 396.70515433, 391.00239674,
    385.47304137, 380.10955321, 374.90435985, 369.84985548, 364.93840469,
    360.16234585, 355.51399428, 350.98564506, 346.56957559, 342.25804785,
    338.04331042, 333.91760027, 329.87314427, 325.90216055, 321.99685959
])

C = np.array([
    1873., 1845.60079179, 1818.21451271, 1790.85407353, 1763.53234818,
    1736.2621556, 1709.05624148, 1681.92726034, 1654.88775775, 1627.95015279,
    1601.12672082, 1574.42957662, 1547.87065782, 1521.46170877, 1495.21426489,
    1469.13963741, 1443.24889869, 1417.55286803, 1392.06209808, 1366.78686179,
    1341.73714001, 1316.92260975, 1292.35263307, 1268.03624659, 1243.98215186,
    1220.19870626, 1196.6939147, 1173.47542209, 1150.55050647, 1127.92607295,
    1105.60864833, 1083.60437657, 1061.91901487, 1040.55793062, 1019.52609903,
    998.82810149, 978.46812465, 958.44996024, 938.77700554, 919.45226459,
    900.47834996, 881.85748531, 863.59150844, 845.68187502, 828.12966284,
    810.93557671, 794.09995377, 777.62276936, 761.50364341, 745.74184714,
    730.33631034, 715.2856289, 700.58807277, 686.24159421, 672.24383635,
    658.59214198, 645.28356263, 632.31486777, 619.68255424, 607.3828558,
    595.41175273, 583.7649816, 572.438045, 561.42622136, 550.72457468,
    540.32796429, 530.23105451, 520.42832422, 510.91407632, 501.68244709,
    492.72741529, 484.04281122, 475.62232543, 467.45951735, 459.54782358,
    451.88056601, 444.45095962, 437.25212003, 430.27707075, 423.51875016,
    416.97001817, 410.62366258, 404.47240509, 398.50890705, 392.72577484,
    387.11556498, 381.67078886, 376.38391722, 371.24738426, 366.2535915,
    361.39491128, 356.66369002, 352.05225117, 347.55289787, 343.15791542,
    338.85957343, 334.65012773, 330.52182212, 326.4668899, 322.47755513
])

err_12 = np.mean(np.abs(A - B))
err_13 = np.mean(np.abs(A - C))
err_23 = np.mean(np.abs(B - C))
print(f"Erreur moy. y/y2 : {err_12:.4f}")
print(f"Erreur moy. y/y3 : {err_13:.4f}")
print(f"Erreur moy. y2/y3 : {err_23:.4f}")

plt.figure(figsize=(10,6))
plt.plot(A, label='Simulation 1')
plt.plot(B, label='Simulation 2', linestyle='--')
plt.plot(C, label='Simulation 3', linestyle='-.')
plt.xlabel("Index")
plt.ylabel("Valeurs")
plt.title("Comparaison des 3 simulations")
plt.legend()
plt.grid(True)
plt.tight_layout()
plt.show()
